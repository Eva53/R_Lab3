---
title: "Лабораторная работа №3, задание 11"
author: "Ефременко Влада"
date: "2022-11-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
***
## Задание ##

На портале открытых данных Тульской области есть данные о распределении площади лесов и запасов древесины по преобладающим породам и группам возраста https://opendata71.ru/opendata/7107096442-stateforestregisterTularegion/table. Скачайте эти данные в виде таблицы CSV и постройте по ним круговую и столбчатую диаграмму для категории Площадь земель, занятых лесными насаждениями (покрытых лесной растительностью), всего. Подберите цвета, попробуйте изменить ориентировку столбцов на горизонтальную, а для круговой диаграммы поменяейте угол поворота. Подпишите значения.

***
Используемые пакеты:
```{r warning=FALSE}
library(ggplot2)
```
***
Путь до файла с данными:
```{r warning=FALSE}
path = '/Users/vladaefremenko/R_Lab3/data/data_tula.csv'
```
***
Функция, отрисовывающая графики:
```{r warning=FALSE}
plot_graphics <- function(df){
  gg1 <- ggplot(data = df, mapping = aes(x = Breeds, y = Value_indicator, fill = Breeds)) +
    geom_col() + coord_flip() +
    xlab("Породы") + ylab("Тыс. га") +
    ggtitle('Площадь земель, занятых лесными насаждениями') + 
    geom_text(aes(label = Value_indicator), vjust = 0.5)
  
  gg1 <- gg1 + guides( fill = guide_legend(title = "Породы", override.aes = aes(label = "")))
  print(gg1)
  
  gg2 <- ggplot(data = df, mapping = aes(x = '', y = Value_indicator, fill = Breeds)) +
    geom_col() + coord_polar(theta = 'y') +
    ggtitle('Площадь земель, занятых лесными насаждениями') + ylab('Тыс. га')
  gg2 <- gg2 + guides(fill = guide_legend(title = "Породы", override.aes = aes(label = "")))
  print(gg2)
}
```
***
Исполняемый код - считываем данные из .csv файла, меняем названия столбцов в датафрейме, выбираем нужные столбцы, меняем тип переменной на вещественную и строим графики: 
```{r warning=FALSE}
data <- read.csv(path, sep=";")
colnames(data) <- c("Breeds", "Name_indicator", "Unit", "Value_indicator")
new_data <- subset(data, Name_indicator == "Площадь земель, занятых лесными насаждениями (покрытых лесной растительностью), всего")
new_data[[4]] <- sub(',', '.', new_data[[4]])
new_data[[4]] <- as.numeric(new_data[[4]])
plot_graphics(new_data)
```